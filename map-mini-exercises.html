<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Map, Filter, Reduce Mini-Exercises</title>
</head>
<body>

<script>
    "use strict";
    // TODO: Given the following array, complete the todos...

    const dogs = [
        {
            dogName: 'Bubbles',
            age: 10,
            isTrained: false
        },
        {
            dogName: 'Lexie',
            age: 3,
            isTrained: true
        },
        {
            dogName: 'Doggy',
            age: 5,
            isTrained: false
        },
        {
            dogName: 'Flopper',
            age: 3,
            isTrained: true
        },
        {
            dogName: 'Lexie',
            age: 1,
            isTrained: true
        },
        {
            dogName: 'Skip',
            age: 7,
            isTrained: true
        },
        {
            dogName: 'Blue',
            age: 4,
            isTrained: false
        }
    ];

    // MAP

    // TODO 1: using map, create a new array of dog names from the dogs array

    // const {dogName, age, isTrained} = dogs

    const dogsNames = dogs.map(function (dog){
        return dog.dogName
    });
    console.log('Exercise 1:', dogsNames);

    // TODO 2: using map, create a new array of dog ages from the dogs array
    const dogsAges = dogs.map(function (dog){
        return dog.age
    });

    console.log('Exercise 2:', dogsAges);

    // TODO 3: using map, create a new array of dog objects from the dogs array that only have dog names and age properties and values
    const dogsObj = dogs.map(function (dog){
        return {
            dogName: dog.dogName,
            age: dog.age
        }
    });
    console.log('Exercise 3:', dogsObj);


    // FILTER

    // TODO 4: using filter, create a new array containing only dogs younger than 10 years old
    const dogsUnder10 = dogs.filter((dog) => dog.age < 10);
    console.log('Exercise 4:', dogsUnder10);

    // TODO 5: using filter, create a new array containing only dogs named 'Lexie'
    const dogsNamedLexie = dogs.filter((dog) => dog.dogName === 'Lexie');
    console.log('Exercise 5:', dogsNamedLexie);

    // TODO 6: using filter, create a new array containing only dogs that are trained and younger than 10
    const dogsTrainedAndUnder10 = dogs.filter((dog) => dog.isTrained === true && dog.age < 10);
    console.log('Exercise 6:', dogsTrainedAndUnder10);


    // REDUCE

    // TODO 7: using reduce, return a string containing all dog names together with no spaces ("BubblesLexieDoggy...")
    const dogsString = dogs.reduce(function (previousValue, currentValue){
    return  previousValue + currentValue.dogName;
    }, '');
    console.log('Exercise 7:', dogsString);

    // TODO 8: using reduce, return the total of adding all dog ages together (18)
    const totalDogYears = dogs.reduce(function (previousValue, currentValue){
        return previousValue + currentValue.age
    }, 0);
    console.log('Exercise 8:', totalDogYears);

    // TODO 9: using reduce, return an array of dog objects with all isTrained properties set to true
    // const trainedDogs = dogs.filter((dog) => dog.isTrained === true);

    const trainedDogs = dogs.reduce(function (previousValue, currentValue) {
        if (currentValue.isTrained) previousValue.push(currentValue)
        return previousValue
    }, []);

    console.log('Exercise 9:', trainedDogs);


    // EXTRA CHALLENGES

    // TODO 10: what is the average age of each dog?
    console.log('Exercise 10:');

    // TODO 11: what is the average age of dogs that are trained?
    console.log('Exercise 11:');

    // TODO 12: what is the average length of names of untrained dogs?
    console.log('Exercise 12:');

    // TODO 13: what are the combined ages of all dogs in dog years? (7x more than a human year)
    console.log('Exercise 13:');

    // TODO 14: create a string of the first letters of each dog name for dogs three years old (should be "LF")
    console.log('Exercise 14:');



    // const numbers = [1, 2, 3, 4, 5];
    //
    // const sum = numbers.reduce((accumulation, currentNumber) => {
    //     console.log('acc: ' + accumulation)
    //     console.log('current: ' + currentNumber)
    //     return accumulation + currentNumber;
    // }, 0);
    //
    // console.log(sum)
    //
    // const salesPeople = [
    //     {name: 'Jim Halpert', sales: 100},
    //     {name: 'Dwight Schrute', sales: 50},
    //     {name: 'Andy Bernard', sales: 150},
    // ];
    //
    // const totalSales = salesPeople.reduce((total, person) => {
    //     console.log('total: ' + total)
    //     console.log('person: ' + person.sales)
    //     return total + person.sales;
    // }, 0);
    //
    // console.log(totalSales)


    function countWords(sentence) {
        const words = sentence.split(' '); // transform a sentence into an array of words
        console.log(words)
        const wordCountObject = words.reduce((wordCounts, word) => {
            console.log('wordCounts: ' + wordCounts)
            console.log('word: ' + word)
            if (typeof wordCounts[word] === 'undefined') {
                // if the word is not yet present in our object, set it's value to 1
                wordCounts[word] = 1;
            } else {
                // otherwise increment the existing count
                wordCounts[word] += 1;
            }
            return wordCounts;
        }, {}); // start with an empty object
        return wordCountObject;
    }

    console.log(countWords('Mary had a little lamb little lamb little lamb'));;
    // {Mary: 1, had: 1, a: 1, little: 3, lamb: 3}














    // Array of numbers someone likes for some reason
    const favoriteNumbers = [11, 17, 15, 12, 100, 7, 1, 3, 9, 50,52, 44, 13, 19];

    const myCats = ['Little One', "Mao Mao", "Lizzy"]

    const arrayOfTVShows = [
        {
            title: "The Office",
            seasons: 9,
            imdbScore: 9,
            firstEpisodeYear: 2005,
            characters: ["Micheal", "Pam", "Jim", "Andy"]
        },
        {
            title: "Game of Thrones",
            seasons: 8,
            imdbScore: 9.3,
            firstEpisodeYear: 2011,
            characters: ["Jon", "Arya", "Sansa", "Tyrion"]
        },
        {
            title: "The Good Place",
            seasons: 4,
            imdbScore: 8.2,
            firstEpisodeYear: 2016,
            characters: ["Janet", "Chidi", "Elenor", "Jason", "Tahani"]
        },
        {
            title: "Breaking Bad",
            seasons: 5,
            imdbScore: 9.5,
            firstEpisodeYear: 2008,
            characters: ["Walter", "Jesse", "Skylar"]
        },
    ]

    // MAP

    // TODO: double each number in the favorite numbers array.

    const doubleNumbersArray = favoriteNumbers.map((number) => number*2);

    console.log("doubleNumbersArray:", doubleNumbersArray)
    console.log("favoriteNumbers:", favoriteNumbers)


    // You could use forEAch to solve the same problem in another way. Although the syntax is longer in many cases
    const forEachExample = [];
    favoriteNumbers.forEach((element) =>  {
        forEachExample.push(element *2)
    })

    console.log("forEachExample:", forEachExample)

    const uppercaseCats = myCats.map((element) => element.toUpperCase())

    console.log("uppercaseCats:", uppercaseCats)

    // This is easily reusable in other map functions
    const mapElementToLI = (element) => `<li>${element}</li>`

    const uppercaseCatsHTML = uppercaseCats.map(mapElementToLI)

    console.log("uppercaseCatsHTML:", uppercaseCatsHTML)


    document.getElementById("myCats").innerHTML = uppercaseCatsHTML.join("")

    //TODO: create a headline that could be accessed later. using the title, seasons and imdbScore

    const mapHeadlineToArray =  (show) => {
        const { title, seasons, imdbScore }  = show

        return {
            ...show, // spread operator, allows you to get all the properties from show and display them in resulted object
            headline: `${title} (${seasons} seasons) has an average IMDB score of ${imdbScore}`
        }
    }
    const headlineTVShows = arrayOfTVShows.map(mapHeadlineToArray);

    console.log("headlineTVShows:", headlineTVShows)


    // FILTER

    // TODO: Get only the odd numbers from the favorite numbers array

    const oddFavorites = favoriteNumbers.filter((number) => number % 2)

    console.log("oddFavorites:", oddFavorites)

    // TODO: From the cats array I want to only get the cats that have a name of 7 or
    //  less characters.

    // You can separate the callback function from the filter if needed for readability or otherwise
    const filterCatsUnder7Characters = (cat) => cat.length < 10
    const catsWithShortNames = myCats.filter(filterCatsUnder7Characters);

    console.log("catsWithShortNames:", catsWithShortNames)

    // TODO: Combine the tools!
    // TODO: take the cats array that you returned from the filter above and map it to the page.

    const catsWithShortNamesHTML = myCats.filter(filterCatsUnder7Characters).map(mapElementToLI)

    console.log("catsWithShortNamesHTML:", catsWithShortNamesHTML)

    document.getElementById("shortNamesCats").innerHTML = catsWithShortNamesHTML.join("");


    // TODO: Filter the movies array such that it would return items 9 or over on the
    //  imdb rating scale and the show is created after or equal to 2008

    // This item filters on two values, you can of course do more if you needed it
    const bestShow = arrayOfTVShows.filter((show) => show.imdbScore >= 9 && show.firstEpisodeYear >= 2008)

    console.log("bestShow:", bestShow)


    // REDUCE


    // TODO: Get the sum of all favorite  numbers

    // const favoriteSum = favoriteNumbers.reduce((previousValue, currentValue) => previousValue+currentValue)
    //
    //
    // console.log("favoriteSum:", favoriteSum)

    const favoriteSum = favoriteNumbers.reduce((previousValue, currentValue, index) => {
        // console.log("index :", index);
        return previousValue+currentValue
    }, 0);

    console.log("favoriteSum:", favoriteSum)

    //TODO:

    const title = 'Full Cats HTML'
    const fullCatsHTML = myCats
        .map(mapElementToLI)
        .reduce((previousValue, currentValue) => previousValue + currentValue, `<h2>${title}</h2><ul>`) + "</ul>"

    console.log("fullCatsHTML:", fullCatsHTML)


    document.getElementsByTagName("body")[0].innerHTML += fullCatsHTML



    // TODO: Create a rollup report that contians the total # of TV Shows, the average IMDB SCORE,
    //  and the all the starting years for the shows


    const initialValue = {
        totalTVShows: 0,
        avgIMDBScore:  0,
        startingYears: []
    }

    const getTVShowsReport = (previousValue, currentValue, index) => {

        let {totalTVShows, avgIMDBScore, startingYears} = previousValue;

        avgIMDBScore = ((avgIMDBScore * index ) + currentValue.imdbScore) / (index + 1);

        startingYears.push(currentValue.firstEpisodeYear)


        return {
            totalTVShows: totalTVShows + 1,
            avgIMDBScore,
            startingYears
        }
    }

    const tvShowReport = arrayOfTVShows.reduce(getTVShowsReport,initialValue);

    console.log("tvShowReport:", tvShowReport);

    const report = [tvShowReport]
        .map((item) => {
            console.log("item :", item);

            const yearsMap = (item, index, array) =>  `<span>${item}</span>${(index < (array.length - 1)) ? "," : "." } `

            return `
        <h2>TV Show Report</h2>
           <div>
            <div>Total TV shows: ${item.totalTVShows}</div>
            <div>Avg IMDB Score: ${item.avgIMDBScore}</div>
            <div>Starting years: ${item.startingYears.map(yearsMap).join("")}</div>
        </div>
        `
        })

    console.log("report:", report)

    document.getElementsByTagName("body")[0].innerHTML += report



</script>
</body>
</html>